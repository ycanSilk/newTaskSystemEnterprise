# 修改 PublisherHeader 和 Notification 页面功能

## 1. 修改 PublisherHeader 组件

### 1.1 添加未读消息数量获取
- 修改消息通知按钮部分代码，调用 `src\app\api\notifications\getNotificationsList\route.ts` API 获取未读消息数量
- 添加 `unreadCount` 状态变量，用于存储未读消息数量
- 在组件加载时获取初始未读消息数量

### 1.2 添加定时轮询功能
- 添加 `useEffect` 钩子，设置定时器
- 每隔10分钟调用一次 API 获取未读消息数量
- 请求成功后直接更新 `unreadCount` 状态，实现无感刷新
- 组件卸载时清理定时器

### 1.3 优化用户体验
- 当未读消息数量为0时，不显示消息数量提示
- 当未读消息数量大于99时，显示"99+"

## 2. 修改 Notification 页面

### 2.1 添加分页功能
- 添加 `currentPage` 状态变量，用于存储当前页码
- 修改 `fetchNotifications` 函数，支持传递页码参数
- 添加分页控件，包括上一页、下一页、页码跳转等功能
- 一页显示20个通知

### 2.2 优化用户体验
- 在分页控件中显示总页数和当前页码
- 当到达第一页或最后一页时，禁用相应的分页按钮
- 添加加载状态，在切换页码时显示加载指示器

## 3. 技术实现细节

### 3.1 API 调用
- 使用 `fetch` 或 `globalFetch` 调用 API
- 处理 API 响应和错误情况
- 确保 API 调用的安全性和可靠性

### 3.2 状态管理
- 使用 React 的 `useState` 和 `useEffect` 钩子管理状态
- 使用 `useRef` 存储定时器引用

### 3.3 性能优化
- 避免不必要的 API 调用
- 优化组件渲染性能
- 确保分页功能的流畅性

## 4. 测试计划

### 4.1 功能测试
- 测试未读消息数量的获取和显示
- 测试定时轮询功能
- 测试分页功能

### 4.2 兼容性测试
- 测试在不同浏览器中的表现
- 测试在不同网络环境中的表现

### 4.3 性能测试
- 测试定时轮询对页面性能的影响
- 测试分页功能的响应速度

通过以上修改，将实现消息通知的实时更新和通知列表的分页显示，提升用户体验。