# 修复组合任务发布页面执行计划

## 1. 问题分析

- **页面**：`src/app/publisher/create/task-combination-middle-bottom/page.tsx`
- **问题**：存在语法错误，包括引用和导入调用错误
- **参考页面**：`src/app/publisher/create/task-combination-top-middle/page.tsx`
- **类型定义**：应使用`src/app/types/task/publishCombineTaskTypes.ts`
- **规范**：需遵循`API_REQUEST_STANDARD.md`

## 2. 修复步骤

### 2.1 修复导入语句
- 将错误的导入语句替换为正确的导入
- 移除未使用的导入
- 确保所有组件和类型都正确导入

### 2.2 修复类型定义
- 使用`publishCombineTaskTypes.ts`中的类型定义
- 删除冗余的类型文件`middelBottomTaskTypes.ts`
- 确保所有变量和函数都使用正确的类型

### 2.3 修复发布任务逻辑
- 替换现有的发布任务函数，使用参考页面的发布逻辑
- 确保截止时间计算正确（分钟转换为秒）
- 确保总价计算正确
- 确保`recommend_marks`数组构建正确

### 2.4 修复图片上传组件
- 确保`ImageUpload`组件的props正确传递
- 修复图片URL处理逻辑

### 2.5 修复支付密码模态框
- 确保`PaymentPasswordModal`组件正确导入和使用
- 修复支付密码处理逻辑

### 2.6 修复其他语法错误
- 移除未定义的变量（如`taskPrice`）
- 修复按钮点击事件处理
- 确保所有函数都正确定义和调用

## 3. 代码结构调整

### 3.1 统一表单数据结构
- 使用`FormData`类型定义表单数据
- 调整表单字段名称以匹配参考页面

### 3.2 统一评论数据结构
- 使用`CommentData`类型定义评论数据
- 调整评论字段名称以匹配参考页面

### 3.3 统一发布任务流程
- 确保发布任务流程与参考页面一致
- 遵循API_REQUEST_STANDARD.md规范

## 4. 验证和测试

### 4.1 运行诊断工具
- 使用`GetDiagnostics`工具检查语法错误
- 确保所有类型错误都已修复

### 4.2 运行开发服务器
- 启动开发服务器
- 测试页面加载和基本功能

### 4.3 测试发布任务流程
- 测试表单验证
- 测试支付密码模态框
- 测试API调用（模拟）

## 5. 最终检查

### 5.1 代码规范检查
- 确保代码遵循API_REQUEST_STANDARD.md
- 确保代码风格一致
- 确保注释完整

### 5.2 功能一致性检查
- 确保页面功能与参考页面一致
- 确保发布逻辑正确
- 确保错误处理一致

## 6. 执行顺序

1. 修复导入语句
2. 修复类型定义
3. 调整表单和评论数据结构
4. 修复发布任务逻辑
5. 修复图片上传组件
6. 修复支付密码模态框
7. 修复其他语法错误
8. 运行诊断工具
9. 运行开发服务器
10. 测试发布任务流程
11. 进行最终检查

这个计划将确保`task-combination-middle-bottom`页面的发布任务功能与`task-combination-top-middle`页面保持一致，遵循API规范，并修复所有语法错误。